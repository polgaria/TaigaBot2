do not attempt to read this code
it's horrible
